---
title: "Homework 2"
output: html_document
---

In this homework, we wish to investigate Abouir, et al., (2022) to assess the validity of several claims. First of all, we need to select the observations out for different analysis.

```{r}
library(idar)
data(codex)

# Cmax
Cmax_men = codex$cmax[codex$gender == 1]
Cmax_women = codex$cmax[codex$gender == 0]
Cmax_obese = codex$cmax[codex$obese == 1]
Cmax_non_obese = codex$cmax[codex$obese == 0]

# Tmax
Tmax_men = codex$tmax[codex$gender == 1]
Tmax_women = codex$tmax[codex$gender == 0]
Tmax_obese = codex$tmax[codex$obese == 1]
Tmax_non_obese = codex$tmax[codex$obese == 0]

# AUC
AUC_men = codex$auc[codex$gender == 1]
AUC_women = codex$auc[codex$gender == 0]
AUC_obese = codex$auc[codex$obese == 1]
AUC_non_obese = codex$auc[codex$obese == 0]
```
### Question 1
1. The first step is still to check the empirical distribution. 

# $C_{\max}$ 

```{r, fig.align='center', fig.height=6, fig.width=12}
par(mfrow = c(1, 2))
boxplot_w_points(Cmax_women, Cmax_men, names = c("Women", "Men"),
                 ylab = "Cmax (ng/ml)")
boxplot_w_points(Cmax_obese, Cmax_non_obese, names = c("Obese", "Non-obese"), ylab = "Cmax (ng/ml)")
```

From the result, we can see that outliers are there. Thus consider the Wilcoxon test to compare the mean in different groups. 
```{r}
wilcox.test(Cmax_women, Cmax_men, alternative = "less")
wilcox.test(Cmax_obese, Cmax_non_obese, alternative = "less")
```
From the result we can see that the p-value = 0.001661 in the first test is much smaller than 0.05, which indicates there is a strong evidence against the null hypotheses in favor of the alternative. We could believe the `cmax` in group of `women` is less than that in `men`. However, for the second test, there isn't an evidence to reject the null hypotheses in which we assert that there is no obvious difference in `cmax` between group of `obese` and `non_obese`.
```{r}
t.test(Cmax_women, Cmax_men, alternative = "less")
t.test(Cmax_obese, Cmax_non_obese, alternative = "less")
```
Comparing the result of `t.test` to `wilcox.test`, we can get the same conclusion for the first test. However the conclusion for second test is opposite. Actually, the p-value in the t-test is around 0.05, which is also an indication of double check. 

Based on the same logic to the Question 1, we could analyse the remaining questions. The following are the code you may need.

# $T_{\max}$

```{r, fig.align='center', fig.height=6, fig.width=12}
par(mfrow = c(1, 2))
boxplot_w_points(Tmax_women, Tmax_men, names = c("Women", "Men"),
                 ylab = "Cmax (ng/ml)")
boxplot_w_points(Tmax_obese, Tmax_non_obese, names = c("Obese", "Non-obese"), ylab = "Cmax (ng/ml)")
```

```{r}
wilcox.test(Tmax_women, Tmax_men, alternative = "less")
wilcox.test(Tmax_obese, Tmax_non_obese, alternative = "less")
```

```{r}
t.test(Tmax_women, Tmax_men, alternative = "less")
t.test(Tmax_obese, Tmax_non_obese, alternative = "less")
```

# AUC

```{r, fig.align='center', fig.height=6, fig.width=12}
par(mfrow = c(1, 2))
boxplot_w_points(AUC_women, AUC_men, names = c("Women", "Men"),
                 ylab = "Cmax (ng/ml)")
boxplot_w_points(AUC_obese, AUC_non_obese, names = c("Obese", "Non-obese"), ylab = "Cmax (ng/ml)")
```

```{r}
wilcox.test(Cmax_women, Cmax_men, alternative = "less")
wilcox.test(Cmax_obese, Cmax_non_obese, alternative = "less")
```

```{r}
t.test(AUC_women, AUC_men, alternative = "less")
t.test(AUC_obese, AUC_non_obese, alternative = "less")
```


